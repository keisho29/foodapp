# ADR-002: アーキテクチャ構造（MVC + DTO + Service分離）の決定

## Status
Accepted

## Context
本アプリケーションでは、以下のような処理が求められる：
- ユーザーからのデータ入力（摂取量など）を受け取って処理する
- PFCやカロリーの合計計算ロジックを管理
- 永続化された食材情報の取得や保存
- Webページ（一覧・登録・編集）の表示

これらの関心ごとを分離し、メンテナンス性・テスト性を高める必要がある。

## Decision
以下の構造に分離することを決定：

- **Controller層**  
  - Webのエンドポイントを担当し、DTOでデータを受け取る
  - サービス層に処理を委譲する

- **ApplicationService層**  
  - アプリ全体の業務ロジックをまとめ、ドメインサービスやリポジトリに橋渡しする
  - データの受け渡しとユースケース処理を整理

- **DomainService層**  
  - PFCやカロリー合計のビジネスロジック（ルール）を記述
  - 再利用可能な計算や整合性ロジックを担う

- **Repository層**  
  - JPAを使ってDBと接続。Entityを扱う

- **DTOクラス**  
  - HTMLフォームなどから受け取るデータ構造。バリデーション付き

- **Entityクラス**  
  - DB永続化のための構造体（@Entity）

## Consequences

### Positive
- レイヤー間の責務が明確になり、疎結合を実現
- テストが容易（ServiceやDomain単体テスト可能）
- 将来的な機能追加にも柔軟に対応可能
- DDD（ドメイン駆動設計）への拡張もしやすい

### Negative
- 小規模アプリとしては少し構造が重くなる
- 初学者にとって理解コストが高い可能性がある
